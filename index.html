<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CTF-Style Networking Quiz</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <meta
      name="description"
      content="Interactive self-checking networking quiz with instant feedback."
    />
    <style>
      .result.ok {
        color: #16a34a;
      } /* green-600 */
      .result.err {
        color: #dc2626;
      } /* red-600 */
    </style>
  </head>
  <body class="bg-slate-50 text-slate-900">
    <main class="max-w-3xl mx-auto p-6 space-y-8">
      <header class="space-y-2">
        <h1 class="text-3xl font-bold">CTF‑Style Networking Quiz</h1>
        <p class="text-slate-600">
          Enter your answers and click
          <span class="font-semibold">Check</span> for instant feedback. Answers
          are not case‑sensitive (unless noted).
        </p>
      </header>

      <!-- Controls -->
      <div class="flex items-center gap-3">
        <button
          id="checkAll"
          class="px-4 py-2 rounded-xl bg-blue-600 text-white hover:bg-blue-700 shadow"
        >
          Check All
        </button>
        <button
          id="resetAll"
          class="px-4 py-2 rounded-xl bg-slate-200 hover:bg-slate-300 shadow"
        >
          Reset
        </button>
        <div id="score" class="ml-auto text-sm text-slate-600"></div>
      </div>

      <section id="quiz" class="space-y-6"></section>

      <footer class="pt-8 text-sm text-slate-500">
        Built for hands‑on networking practice. Tip: try
        <code class="px-1 py-0.5 bg-slate-200 rounded">nmap</code>,
        <code class="px-1 py-0.5 bg-slate-200 rounded">dig</code>,
        <code class="px-1 py-0.5 bg-slate-200 rounded">whois</code>, and
        <code class="px-1 py-0.5 bg-slate-200 rounded">curl</code>.
      </footer>
    </main>

    <script>
      // Helpers
      const normalizeList = (s) => {
        // Convert to set of numbers (ports) ignoring order & spaces
        return new Set(
          (s || "")
            .split(/[,\s]+/)
            .filter(Boolean)
            .map((x) => parseInt(x, 10))
            .filter((n) => Number.isInteger(n))
        );
      };

      const setsEqual = (a, b) =>
        a.size === b.size && [...a].every((v) => b.has(v));

      const onlyDigits = (s) => (s || "").replace(/[^0-9]/g, "");

      const toLower = (s) => (s || "").trim().toLowerCase();

      const ipRegex = /^\s*(?:\d{1,3}\.){3}\d{1,3}\s*$/;

      // Question bank
      const questions = [
        {
          category: "Networking Basics",
          prompt: "What ports are open on quiz.zyrrel.xyz? (comma-separated)",
          placeholder: "e.g., 80, 443, 8080, 8443",
          validator: (input) => {
            const correct = new Set([80, 443, 8080, 8443]);
            const user = normalizeList(input);
            return setsEqual(user, correct);
          },
          feedback: {
            ok: "Correct! Those are the open ports.",
            err: "Not quite. Enter the exact set of ports (order doesn't matter).",
          },
        },
        {
          category: "DNS / Mail",
          prompt:
            "What is one IP address that the highest priority ProtonMail MX for <code>protonmail.com</code> resolves to?",
          placeholder: "e.g., 185.70.42.128",
          validator: (input) => {
            const ok = new Set([
              "185.70.42.128",
              "176.119.200.128",
              "185.205.70.128",
            ]);
            return ok.has((input || "").trim());
          },
          feedback: {
            ok: "Nice! Any one of those IPs is accepted.",
            err: "That's not one of the accepted IPs for the highest‑priority MX. Try again.",
          },
        },
        {
          category: "Protocols & HTTP",
          prompt:
            "Visit <code>example.com</code>. What HTTP status code does the server return for <code>/</code>?",
          placeholder: "e.g., 404",
          validator: (input) => (input || "").trim() === "404",
          feedback: {
            ok: "Correct — 404.",
            err: "Nope — check with <code>curl -I https://example.com/</code>.",
          },
        },
        {
          category: "Service Discovery",
          prompt: "Find the flag running on host <code>167.99.175.252</code>.",
          placeholder: "e.g., LZ{...}",
          validator: (input) =>
            (input || "").trim() === "LZ{http_on_nonstandard_port_2512}",
          feedback: {
            ok: "Correct flag!",
            err: "Incorrect flag. Keep scanning and enumerating.",
          },
        },
        {
          category: "Subnets & IPs",
          prompt:
            "What’s the broadcast address for <code>192.168.37.197/27</code>?",
          placeholder: "e.g., 192.168.37.223",
          validator: (input) => toLower(input) === "192.168.37.223",
          feedback: {
            ok: "Correct — 192.168.37.223.",
            err: "Nope — calculate the /27 block. (Hint: block size is 32 addresses.)",
          },
        },
        {
          category: "Subnets & IPs",
          prompt:
            "If an IP is <code>10.0.0.15</code> with mask <code>/8</code>, how many usable hosts exist in that subnet?",
          placeholder: "e.g., 16,777,214",
          validator: (input) => {
            const digits = onlyDigits(input);
            return digits === "16777214"; // accept with or without commas/words
          },
          feedback: {
            ok: "Correct — 16,777,214 usable hosts.",
            err: "Not quite. Remember to subtract network and broadcast from 2^(32-8).",
          },
        },
        {
          category: "Fun / OSINT",
          prompt:
            "A device has IP <code>192.168.23.5/24</code>. What is the most common default gateway IP for home networks in that subnet?",
          placeholder: "e.g., 192.168.23.1",
          validator: (input) => toLower(input) === "192.168.23.1",
          feedback: {
            ok: "Yep — 192.168.23.1 is the common default gateway format.",
            err: "Try the typical '.1' gateway for that /24 network.",
          },
        },
        {
          category: "Routing / ASN",
          prompt: "Which company owns the ASN for <code>1.1.1.1</code>?",
          placeholder: "e.g., Cloudflare",
          validator: (input) => {
            const s = toLower(input);
            return s.includes("cloudflare"); // accept "cloudflare" or "cloudflare, inc."
          },
          feedback: {
            ok: "Correct — Cloudflare (AS13335).",
            err: "Nope — check whois/ASN lookup for 1.1.1.1.",
          },
        },
      ];

      // Render
      const quizEl = document.getElementById("quiz");

      questions.forEach((q, i) => {
        const card = document.createElement("article");
        card.className =
          "rounded-2xl bg-white shadow p-5 border border-slate-200";

        card.innerHTML = `
        <div class="text-xs uppercase tracking-wide text-slate-500 mb-1">${
          q.category
        }</div>
        <div class="text-lg font-medium mb-3">${q.prompt}</div>
        <div class="flex flex-col sm:flex-row gap-3">
          <input type="text" class="flex-1 px-3 py-2 rounded-xl border border-slate-300 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="${
            q.placeholder || ""
          }" />
          <div class="flex gap-2">
            <button class="check px-4 py-2 rounded-xl bg-emerald-600 text-white hover:bg-emerald-700">Check</button>
            <button class="clear px-4 py-2 rounded-xl bg-slate-200 hover:bg-slate-300">Clear</button>
          </div>
        </div>
        <div class="result mt-2 text-sm"></div>
      `;

        quizEl.appendChild(card);
      });

      const updateScore = () => {
        const results = [...document.querySelectorAll(".result")];
        const correct = results.filter((r) =>
          r.classList.contains("ok")
        ).length;
        document.getElementById(
          "score"
        ).textContent = `Score: ${correct}/${questions.length}`;
      };

      // Wire up buttons
      document.querySelectorAll("#quiz article").forEach((card, idx) => {
        const input = card.querySelector("input");
        const checkBtn = card.querySelector("button.check");
        const clearBtn = card.querySelector("button.clear");
        const result = card.querySelector(".result");

        const runCheck = () => {
          const valid = questions[idx].validator(input.value);
          result.textContent = valid
            ? questions[idx].feedback.ok
            : questions[idx].feedback.err;
          result.classList.remove("ok", "err");
          result.classList.add(valid ? "ok" : "err");
          updateScore();
        };

        checkBtn.addEventListener("click", runCheck);
        input.addEventListener("keydown", (e) => {
          if (e.key === "Enter") {
            runCheck();
          }
        });
        clearBtn.addEventListener("click", () => {
          input.value = "";
          result.textContent = "";
          result.classList.remove("ok", "err");
          updateScore();
          input.focus();
        });
      });

      document.getElementById("checkAll").addEventListener("click", () => {
        document.querySelectorAll("#quiz article").forEach((card, idx) => {
          card.querySelector("button.check").click();
        });
      });

      document.getElementById("resetAll").addEventListener("click", () => {
        document.querySelectorAll("#quiz article").forEach((card) => {
          card.querySelector("button.clear").click();
        });
        document.querySelector("input")?.focus();
      });

      // Initialize score
      updateScore();
    </script>
  </body>
</html>
